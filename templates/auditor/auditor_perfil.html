{% extends 'base.html' %}
{% load static %}

{% block title %}Perfil - DataEasy{% endblock %}

{% block styles %}
<link rel="stylesheet" href="{% static 'css/perfil.css' %}">
{% endblock %}

{% block content %}

<div class="perfil-wrapper">
    <div class="perfil-card">

        <h2>Informaci√≥n de usuario</h2>

        <form class="perfil-form">

            <label>Nombre de usuario:</label>
            <input type="text" value="{{ user.username }}" disabled>

            <label>Cargo:</label>
            <input type="text" value="Administrador" disabled>

            <label>Correo electr√≥nico:</label>
            <input type="email" id="emailInput" placeholder="correo@ejemplo.com" disabled>

            <label>N√∫mero de tel√©fono:</label>
            <input type="text" id="phoneInput" placeholder="+56 9 0000 0000" disabled>

            <div class="perfil-buttons">
                <button type="button" id="editBtn" class="btn btn-primary">‚úèÔ∏è Editar</button>
                <button type="button" id="saveBtn" class="btn btn-success hidden">üíæ Guardar</button>
            </div>

        </form>

    </div>
</div>

{% endblock %}

{% block scripts %}
<script>
const username = "{{ user.username|escapejs }}";
const keyEmail = `profile_email_${username}`;
const keyPhone = `profile_phone_${username}`;
const emailInput = document.getElementById("emailInput");
const phoneInput = document.getElementById("phoneInput");
const editBtn = document.getElementById("editBtn");
const saveBtn = document.getElementById("saveBtn");

document.addEventListener("DOMContentLoaded", () => {
    const savedEmail = localStorage.getItem(keyEmail);
    const savedPhone = localStorage.getItem(keyPhone);
    if (savedEmail) emailInput.value = savedEmail;
    if (savedPhone) phoneInput.value = savedPhone;
});

editBtn.onclick = () => {
    emailInput.disabled = false;
    phoneInput.disabled = false;
    editBtn.classList.add("hidden");
    saveBtn.classList.remove("hidden");
};

saveBtn.onclick = () => {
    localStorage.setItem(keyEmail, emailInput.value.trim());
    localStorage.setItem(keyPhone, phoneInput.value.trim());
    emailInput.disabled = true;
    phoneInput.disabled = true;
    saveBtn.classList.add("hidden");
    editBtn.classList.remove("hidden");
};
</script>
{% endblock %}
