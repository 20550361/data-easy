{% extends 'base.html' %}
{% load static %}

{% block title %}Gesti√≥n de Usuarios - DataEasy{% endblock %}

{% block styles %}
<style>
    .badge { padding: 4px 8px; border-radius: 12px; font-size: 0.8em; font-weight: bold; }
    .badge-admin { background-color: #f8d7da; color: #721c24; }
    .badge-staff { background-color: #fff3cd; color: #856404; }
    .badge-user { background-color: #e2e3e5; color: #383d41; }

    .btn-primary, .btn-edit, .btn-delete {
        display: inline-block;
        padding: 8px 14px;
        border-radius: 8px;
        text-decoration: none;
        font-weight: 600;
        transition: all 0.2s ease;
    }
    .btn-primary { background: #2C3E50; color: #fff; }
    .btn-edit { background: #3498DB; color: #fff; margin-right: 6px; }
    .btn-delete { background: #E74C3C; color: #fff; }
    .btn-edit:hover { background: #217dbb; }
    .btn-delete:hover { background: #c0392b; }

    .table-container table {
        width: 100%;
        border-collapse: collapse;
        margin-top: 16px;
    }
    table th, table td {
        padding: 10px;
        border-bottom: 1px solid #ddd;
        text-align: left;
    }
    table th { background: #f8f9fa; }
</style>
{% endblock %}

{% block content %}
<h2>üë• Gesti√≥n de Usuarios</h2>
<p>Administra las cuentas y permisos de los usuarios del sistema.</p>

<div class="toolbar">
    <a href="{% url 'usuario_crear' %}" class="btn-primary">‚ûï Crear Nuevo Usuario</a>
</div>

<div class="table-container">
    <table>
        <thead>
            <tr>
                <th>Usuario</th>
                <th>Email</th>
                <th>Rol</th>
                <th>Miembro desde</th>
                <th>Acciones</th>
            </tr>
        </thead>
        <tbody>
            {% for usuario in lista_usuarios %}
            <tr>
                <td><strong>{{ usuario.username }}</strong></td>
                <td>{{ usuario.email|default:"N/A" }}</td>
                <td>
                    {% if usuario.is_superuser %}
                        <span class="badge badge-admin">Super Admin</span>
                    {% elif usuario.is_staff %}
                        <span class="badge badge-staff">Staff</span>
                    {% else %}
                        <span class="badge badge-user">Usuario</span>
                    {% endif %}
                </td>
                <td>{{ usuario.date_joined|date:"d M Y" }}</td>
                <td>
                    <a href="{% url 'usuario_editar' usuario.id %}" class="btn-edit">‚úèÔ∏è Editar</a>

                    {% if not usuario.is_superuser %}
                    <form action="{% url 'usuario_eliminar' usuario.id %}" method="post" style="display:inline;">
                        {% csrf_token %}
                        <button type="submit" class="btn-delete" onclick="return confirm('¬øSeguro que deseas eliminar al usuario {{ usuario.username }}?');">üóëÔ∏è Eliminar</button>
                    </form>
                    {% endif %}
                </td>
            </tr>
            {% empty %}
            <tr>
                <td colspan="5">No se encontraron usuarios.</td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
</div>
{% endblock %}
